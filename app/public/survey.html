<!DOCTYPE html>
<html>

<head>
    <title>Friend Finder</title>
    <script src="https://code.jquery.com/jquery.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>

<body>

    <h1>Welcome to Friend Finder!</h1>
    <form id="ff">
        <input name="name" placeholder="Enter your name." id="name">
        <br>
        <input name="photo" placeholder="Put a link to your photo here." id="photo">
        <br><br>
        <p>Scale of 1-5. How much do you like pie?<br>
            <input type="radio" name="question1" value="1" class="radio1" checked="checked"> 1
            <input type="radio" name="question1" value="2" class="radio1"> 2
            <input type="radio" name="question1" value="3" class="radio1"> 3
            <input type="radio" name="question1" value="4" class="radio1"> 4
            <input type="radio" name="question1" value="5" class="radio1"> 5
        </p>
        <p>Why is a cow?<br>
            <input type="radio" name="question2" value="1" class="radio2" checked="checked"> 1
            <input type="radio" name="question2" value="2" class="radio2"> 2
            <input type="radio" name="question2" value="3" class="radio2"> 3
            <input type="radio" name="question2" value="4" class="radio2"> 4
            <input type="radio" name="question2" value="5" class="radio2"> 5
        </p>
        <p>Scale of 5-1. Corn?<br>
            <input type="radio" name="question3" value="1" class="radio3" checked="checked"> 1
            <input type="radio" name="question3" value="2" class="radio3"> 2
            <input type="radio" name="question3" value="3" class="radio3"> 3
            <input type="radio" name="question3" value="4" class="radio3"> 4
            <input type="radio" name="question3" value="5" class="radio3"> 5
        </p>
        <p>Everything is Awesome!<br>
            <input type="radio" name="question4" value="1" class="radio4" checked="checked"> 1
            <input type="radio" name="question4" value="2" class="radio4"> 2
            <input type="radio" name="question4" value="3" class="radio4"> 3
            <input type="radio" name="question4" value="4" class="radio4"> 4
            <input type="radio" name="question4" value="5" class="radio4"> 5
        </p>
        <p>Star Wars trek or Star Trek wars?<br>
            <input type="radio" name="question5" value="1" class="radio5" checked="checked"> 1
            <input type="radio" name="question5" value="2" class="radio5"> 2
            <input type="radio" name="question5" value="3" class="radio5"> 3
            <input type="radio" name="question5" value="4" class="radio5"> 4
            <input type="radio" name="question5" value="5" class="radio5"> 5
        </p>
        <p>I like hobbies.<br>
            <input type="radio" name="question6" value="1" class="radio6" checked="checked"> 1
            <input type="radio" name="question6" value="2" class="radio6"> 2
            <input type="radio" name="question6" value="3" class="radio6"> 3
            <input type="radio" name="question6" value="4" class="radio6"> 4
            <input type="radio" name="question6" value="5" class="radio6"> 5
        </p>
        <p>Why is a cow?<br>
            <input type="radio" name="question7" value="1" class="radio7" checked="checked"> 1
            <input type="radio" name="question7" value="2" class="radio7"> 2
            <input type="radio" name="question7" value="3" class="radio7"> 3
            <input type="radio" name="question7" value="4" class="radio7"> 4
            <input type="radio" name="question7" value="5" class="radio7"> 5
        </p>
        <p>I don't own a TV.<br>
            <input type="radio" name="question8" value="1" class="radio8" checked="checked"> 1
            <input type="radio" name="question8" value="2" class="radio8"> 2
            <input type="radio" name="question8" value="3" class="radio8"> 3
            <input type="radio" name="question8" value="4" class="radio8"> 4
            <input type="radio" name="question8" value="5" class="radio8"> 5
        </p>
        <p>Hotdogs or Hamburgers?<br>
            <input type="radio" name="question9" value="1" class="radio9" checked="checked"> 1
            <input type="radio" name="question9" value="2" class="radio9"> 2
            <input type="radio" name="question9" value="3" class="radio9"> 3
            <input type="radio" name="question9" value="4" class="radio9"> 4
            <input type="radio" name="question9" value="5" class="radio9"> 5
        </p>
        <p>Is this a good question???<br>
            <input type="radio" name="question10" value="1" class="radio10" checked="checked"> 1
            <input type="radio" name="question10" value="2" class="radio10"> 2
            <input type="radio" name="question10" value="3" class="radio10"> 3
            <input type="radio" name="question10" value="4" class="radio10"> 4
            <input type="radio" name="question10" value="5" class="radio10"> 5
        </p>
        <button id="formButton" type="submit" class="btn btn-primary btn-md">submit</button>
    </form>

    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Figrin D'an</h4>
                </div>
                <div class="modal-body">
                    <p>Please fill in all fields.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myNewFriend" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Figrin D'an</h4>
                </div>
                <div class="modal-body">
                    <p>Your new friend!</p>
                    <div id="friendPic"></div>
                    <div id="friendName"></div>
                    <div id="friendScore"></div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>

        <script type="text/javascript">
            var mat = 0;
            var matches;
            var x;
            var t = 0;
            var b = 100;

            $("#formButton").on("click", function(event) {
                event.preventDefault();

                var newFriend = {
                    name: $("#name").val().trim(),
                    photo: $("#photo").val().trim(),
                    questions: [
                        $('.radio1:checked').val(),
                        $('.radio2:checked').val(),
                        $('.radio3:checked').val(),
                        $('.radio4:checked').val(),
                        $('.radio5:checked').val(),
                        $('.radio6:checked').val(),
                        $('.radio7:checked').val(),
                        $('.radio8:checked').val(),
                        $('.radio9:checked').val(),
                        $('.radio10:checked').val()
                    ]
                };

                if ($("#name").val().trim() != "" && $("#photo").val().trim() != ""){



                    console.log(newFriend);

                    $.post("/api/friends", newFriend)
                        .done(function(data) {
                            matches = data;
                            console.log(data);


                            for (i = 0; i < matches.length; i++) {
                                t = 0
                                for (x = 0; x < newFriend.questions.length; x++) {
                                  if (newFriend.questions[x] === undefined){$("#myModal").modal();};
                                    t += Math.abs(parseInt(newFriend.questions[x]) - parseInt(matches[i].questions[x]));
                                }
                                if (t < b) {
                                    b = t;
                                    mat = i;
                                };
                            }




                            $("#friendPic").html("<img id='borg' src='" + data[mat].photo + "' 'style=max-width:100%; max-height:100%;'>");
                            $("#friendName").text(data[mat].name);
                            $("#friendScore").text(100 - parseInt(b));
                            $("#myNewFriend").modal({ close : function(){
                  location.reload();
              }});
                        });
                } else {
                    $("#myModal").modal();
                }


            });
        </script>




</body>

</html>
